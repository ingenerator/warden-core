### Unreleased

### v1.2.1 (2022-10-24)

* Checking MX records for valid emails is unreliable and hes been dropped from symfony/validation. Utilise 'strict' mode instead to check the address looks valid.

### v1.2.0 (2022-10-17)

* Support PHP 8.1 and PHP 8.2

### v1.1.2 (2021-05-06)

* UserRegistrationInteractor is now more amenable to extension. The makeUser method can now be easily overridden to allow applications to specify how the user should be provided. See f975cf3f19080a36bd29f10e7906c9c6a844c5bb for more detail.

* LoginInteractor is also more amenable to extension. The doPasswordResetEmail method can now be extended to allow applications to respond with alternatives, for example: when the user is inactive you may want them to complete registration rather than just reset password. It will always now return a LoginResponse::notActive for inactive users, failed or successful passwords

* The entire EmailVerificationRequest is now available through ConfirmationRequiredNotification to improve extensibility in cases where you might override the Request to carry additional properties. In a future version ConfirmationRequiredNotification::__construct() could be disabled, and the parameters extracted directly from the request at runtime rather than at instantiation.

### v1.1.1 (2021-04-21)

* Support PHP8.0

### v1.1.0 (2020-10-29)

* Support php7.4

### v1.0.0 (2019-04-03)

* Ensure php7.2 support
* Drop php5 support

### v0.3.0 (2018-10-04)

* [BREAKING] Login attempts are now rate limited by user-email and globally. You will need to provide 
  configuration for the `warden.login.global` and `warden.login.user` bucket types, and to handle
  the LoginResponse::ERROR_RATE_LIMITED errors.
* [Internal BREAKING] PasswordResetInteractor and UserRegistrationInteractor now provide endpoints to 
  validate the token and token parameters without calling the main usecase - this allows for controllers
  to show an error and handle invalid tokens immediately rather than after the user submits the form.
  The validation response includes the user if one was matched but this SHOULD NOT be publicly exposed 
  unless the token was valid. Otherwise it may be possible to craft a user enumeration attack by sending 
  incremental user IDs with no token. 
* [BREAKING] Password reset links now carry user_id, not email - as a result any links issued before 
  upgrading to this version will be invalid.
* [Internal BREAKING] Refactor how signed tokens are passed to and validated within interactors, 
  including that the expected parameters are now generated by creating an EmailVerificationRequest
  that *should* match the original one and using the parameters it generates to compare the signature.
  This reduces duplication between the verifying and token generating code.  
* [Feature] Now explicitly returns instead of throwing if a login request causes an email verification,
  and that verification fails because the email is invalid. This might happen because of temporary DNS
  resolution errors at the server or the user's mail domain. Best handling of 
  `LoginResponse::ERROR_EMAIL_VERIFICATION_FAILED` is likely to be to show a "temporary error" message.
* [Feature] Can now trigger and complete email verification for inactive accounts, including that an
  activation is sent automatically on attempt to login to inactive account when the correct password 
  is used. Using the wrong password (or if the account has no password) will result in a password 
  reset which will also activate the account on completion.  
* [Feature] Email verification notifications now carry the user they are requested for - if any - to
  allow use of user actual name in password reset etc notification messages
* [BREAKING] Minimum password length is now 8 characters, html constraints in views will need to be
  updated.
* [Feature] Add new request, interactor etc for an authenticated user to change their password
* [Feature] Add new request, interactor etc for a user to change their email address with an
  email verification step before the change is persisted. 
* [BREAKING] Refactor responsibility for generating parameters for email verification links : 
  now produced by the EmailVerificationRequest to allow for simpler addition of new kinds of 
  links / tokens.
* [BREAKING] Add leaky-bucket based rate limiting of email verifications sent to users:
  * Adds new constructor dependency to EmailVerificationInteractor
  * Adds new possible EmailVerificationResponse with status ERROR_RATE_LIMITED - which means
    an email would have been sent but wasn't because that user has already been sent one/some of 
    that type.
  * Adds new possible LoginReponse with status ERROR_PASSWORD_INCORRECT_RESET_THROTTLED - which
    means they got their password wrong and we would have sent an email but we've already recently
    sent some. End-user applications may want to show this separately, or treat it the same as an
    ERROR_PASSWORD_INCORRECT to handle it silently.
* [Feature]  Automatically update user password hash on login if hash configuration has changed
* [internal] Extract SaveSpyingUserRepository mock for reuse
* [BREAKING] Rename UserNotificationMailer::send to ::sendWardenNotification
* [BREAKING] Rename UserRepository methods to ingenerator conventions
* [BREAKING] UserRepository now throws if loading user with an unknown ID

### v0.2.1 (2018-09-26)

* Support email verification request for when a new user is invited e.g. server-side by an admin. Allow the code to 
  follow the password-reset flow but specifiy a different email template for the message.

### v0.2.0 (2018-03-13)

* Improve / extend the UrlProvider interface to cover customisation of more URLs and support single-action controllers.
  Also means that all expected / generated URLs have changed so this is breaking for any links that have been produced
  which will all now be invalid.

### v0.1.0 (2018-02-13)

* First version, extracted from host project
